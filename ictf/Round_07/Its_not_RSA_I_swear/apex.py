from Crypto.Util.number import *
from functools import reduce

"""
LCG Cracker
"""
def get_inc(states, m, n):
	s1 = states[0]
	s2 = states[1]
	return ( s2 - m * s1) % n

def get_mult(states, n):
	s1 = states[0]
	s2 = states[1]
	s3 = states[2]
	m = ((s3 - s2) * inverse(s2-s1, n)) % n
	return m

def get_mod(states):
	diffs = [b - a for a, b in zip(states, states[1:])]
	z = [a*c - b**2 for a, b, c in zip(diffs, diffs[1:], diffs[2:])]
	n = reduce(GCD, z)
	return n

def get_nonce(data, c):
	"""
	c = pow(e, d, n) * pow(nonce, -1, n) % n
	nonce = inv_mod( c * inv_mod( pow(e, d), n ) , n)
	"""	
	nonce = []

	for i in range(len(data)):
		nonce.append( inverse( c[i] * inverse( pow(e, int(data[i], 16)), n ), n) )
	return nonce


def crack(m, a, b, nonce, enc_flag):
	flag = ''	
	hexchars = '0123456789abcdef'
	for c in enc_flag:
		nonce = (a*nonce + b) % m
		for d in hexchars:
			if pow(e, int(d, 16), n) * pow(nonce, -1, n) % n == c:
				flag += d
	return flag


if __name__ == '__main__':

	n = 16708170927863988699303511703582888580734997138733911328984636007933965290905325642774778340297396061131798306164460278129517083310035777586281703673878322431716769204833296694005607872268259785455287085267891757892373640882346355867292825629126924091555617885260321167967344633886590385637466731431709997496127820004129734330203153379851414061718188705700820657401988926015812755833332095465038250696688873921308577253539016925145071288410691725257264984841577629107244354427720109515216397255336486103350641830962939419559287753329364185289998691915355692721016399373024407209305683358059566362471518291088167295769
	e = 8373521645459565876325540346458145944566179982463150640760080193853900230426576672193576960671343461538536484665473530774866101506996985348421590506076154133851841306538161193251816894633984706652597967914152050285386044427655409146338380406692185231546910113657523105614737657787202154785128040687651692229121658298109029715123136880599750881038669711472423218164611666141321477907571190632271920241486257376201242277054665804607091852316637986085280357703017619059365045566737161229615084783993688089896760032207461280098362898876477836076360496342283140606474272808677459019401700247714299986278560164391874929127

	enc_flag = [10007381756047886360725658874514455992087993800923496912707566335582907453932120850043293080156369800034358168689954286610162143628058403205114493715823137972028831750086986750179502621280138161011175522029523808563617954509615540816533278068826638510813444391197473916279337431334408425249737951336577749638048837475852202756783539739092619260889884725108919990396436628901976211205209978525727284496521832501360657545971821816051769813938500699466297954509843993021366891369752599899016283584792795601144359995335759300823687847499866721770456168312482151949847675615215460851139471395366392698790400079715600624039, 4158494556095021718509420417412186509192609448328685206206667680172399864142023821047225990402443086909912329845712484886939664916082158368567233234961778848876789222635995365953865839261775440186373336822406744411010864292622854481222153797303916800926746603518126227949584013870439095055171598433399995198677416560158534937685182768559901624558538402937301494842293409932726324045888776481824879019659966354724069392050309529094225278882503904678106565098493154609160527465131987370400984850791301252742125992409103126012609232431352181350215909567278947014016753959469737480344586750764173996519975704466791964094, 4453821756567412634205112935590851041297496128602712204152806231885153920332510603897317460231423344578177712267088478943851196031060717634334563307761556844643632526565897751205350696764917692939121177692934126788066836742521158337280091377189146127105399936427176679935876721250404726246380272728586614185976776107713665873936096441777615698165747874385249865340623991119756641660250453042769344882912358753536977929089792149451358919186207823946326172690873240543811369468041862717454369170276930002520879629223417951451489559667655199863817037622077039951248703703860582471458224086406047013519823727091362734027, 544656857269153669520059985267594648688182257506024990996645592458479033687945350270678219837623934441607714136124244332091309038088562162553033008076430202101734966394901604492704270137577750995536657910173831770629043855685220107655018453600729529460090635167070811050401231517057240197668464435581627301481709248104711955481556678027583200044072600979524642517781896994027809259785186848142148302559966240984644097718868795290817122237376174401286000553791192424372208475103667039156106629975197100966140616514125119328330368418284657373130196372761353656771241500045401772267571796516016156422523117292820334698, 5143296506637715397095661464990030457271874475222975926807784183550427901612836761248597062104175275763767943858269069788979912327716444248833261853332930228321986410120367768502960886625336732741849272867175639240148738253737103377525370193370215753497412209471183588765581020764013709253413799662251327720440089928380612527259855500766135702310965650835457661848173991226427234891059984444881110970583627910033526156368277902484901788185043156512984529838976399714792642958854969673188108843695773317597898348219718467496499378696544799968355005893813577046969673447843658005618449430966478815883807327250810066808, 8138625107373845731886963856688366323877650386633879488986541555059345581073784987637054362121809263076719728722361078319374626637774977661456385633726716342507152967109271818410210934597462180179513615739129579013901437348945701024371751874909341526590643373568283316482031909586581135341350827092262681665230378766418437850568502248164289378999425587274502481394637839931081142685470460014740769721621439509856630896161882053175437167659944563403298050429482280056586178710940224755092809577197159074806019167707474792246958595674325528919233938956203977544999056598675380358008625878629956308304905629791153936114, 88091302110553729888720800205629574161882647729051541419599497918820416475603522797527826242040238689943518837990982059423618200900142043273321180414976862968320674977103056136298275114748764697003099471496816352797949732623917374387686902982244178811133855134381556953287476623755327194734710301263174750718907098070460071274619301493590681517190517951172186631934664993881279608805108690757395707877120663200336799401389114867213130587199732697592465363553832014933082654613082018661365922769838221864702840721774152471041329876685052164945643432357630489162351721047229409583455454803945518990503054819623448198, 4568816705723105188833098871902835956323013179356607641208672345359759428743577347252561028929401714067974377192380713547326349985981135871551048357013039334955430837444768908462740801281200321138516387163209735182554012093541097283710018838654633960883122491035509071401192816684265883541874236966490543737552915219022923963665756124349011118419216278479447876941394315582237389711160757965267111055696709633166573307780090053557871005158296988658584543555573756533864949351112848569595130802142199576634575835471406839901898524246144136407708426653116155739812858230451421723581893837882148967770415343509745479438, 9779017118224292700475845748521286010943102324914192517370613506645588280226380436708318997875747538295477066386289785371238620808878715227973720646715437577618385221931405047649720885583059859521981464974632585096013751367192648778958546845970657674200571974402883499705251801161973616414447817443595629533464307069148433767007337865880042742180633912030078128745743963753309491828528422878747396634694929045976154921864949927115801528266865591227272524277644156463772087683024410800714207807326974820325924168758105914650670989284787335819100742064090582514943380435518506594878836104051351711376922637069782273714, 12123445601760894600206425253816537918140649492243917001392856491803071958010650643380319005241649086838575504807284616001257905951440174056332034676764308719980441546622412141957790385233516665218871460160351995577559350672548842062983395370342922433878597825725312169527885650850442792845456928442437149008137820807300042878474968440162436728051827704037322481008366051028210956007912704193161541254233045545281024181112526333252530465930249843987578454463666492722452004589129662151672955836650672424071582630527663769007246607049389388454693465779388520476134006617825788430051580191819394901836488541145796977679, 5509921334218740901894867100451298624625912301079642317427806639152631025065430522070123446149261059655631472323233760688032471404161340516093661429999141807306019305894303237001550194675668233312730225476193592545828023173277854773462007499498363087549174905207266133975367845197187361273443598179494695500393160844658773449825480756959079604721923276384957353245215635514080518173816485133902327008186763481660810179000803566298896680558354599606567676570649941458293608181906401033122423332297943664314314655774161540051713977503816311112796495725207284734982402143294589813210594594055428534991488393948750075869, 7503699905788272516339300646712672665626448613405969201827483769667445973452472434249079287372223624755634866103016809775319428083577576857729007562925331212370111201592195894763104404427285060903272626024242419965757162987340040068558504355427339585612567702734053106562948221735301658431473763405150601643456469050233618046541149246498027481818288575784876877987359854764282576691885819997248011735358946150590405577293626669807206891098808770150961101490873860095568319750061836447784932296150136319192864459282887926778469381852006841003071292357749305731263359164986312747258923488459075410295479125723113833187, 7711362997417759460771324034335515787653255793032147136729708274036709116332929192133987371516177130617316798402315827635119833957097391787105730645738699910062825521490931871926672193014843666913809103254061937662227727891714308020691988409658046597013409415873099445952123915335276109373712283453034830478454400884199234067214688701402584629659304730766558415596479922264120435848602682658481438387803211729758705175495333450135072000750320222938853315923907935744601740259886414437126551040540377747488798815184073036579623059047704573102126948407212469393315508756413179086603872939967146728361834772816227166104, 6455954059262139810317919233395133226423088701150538487818042333108999384237358632911221807218617236600610211754461344751257272975691396764568494070791637812030307664460991697723390243492515810571871755269725806989305598519157060402355651449656984178626392635950786955971675111314393444965259475170401338733999781441980393110273025789666552212023555734548508876080441879815257406258523020498826342455448416806850535865936116290519190555816706784578560892861908268597689528391299457189006763335867486262448301513167234214242471879137859719757346085835903441813876398540127743421567596039786623071137368583549287341692, 10266988962334590150989850099411227709885786838915067003917262870735873098472032117174612030832009046286914448715704899841619398979498296350911339977021381678125306659992439340749250659329897901557617363346761300655050359868181377748606715710638580938048162467397857861029435319131451684485865379040488773025522304532377193153892087161973675241177364581921955273146802762350623163159132247236382184754401698924595897571056056560403630767149763296352249554399971886053683928038541193307980289478706382778254522811960213452737901990385880711845999862401419326150922409757763373034729533795826507591761294209638793929021, 3549021928485678523207646575903717639649382073004420579514307049197330564068518462051337574009638430533946385683057002459800624674544594086000137903211901258193879639445043381516265003545074119039186070503098407855329639807962117795546764584430293393490570430474393941815444316200322962068591145784392628816711752877497059257125751044017943552995858136805325456367010958631836643749932086006183518318155685014710659035140967023550129487424228598731926216156121550878530257542013337229241005101093746699161493186141831957560268155851726628400350454394698028745746340657379850935869043055080990170239841510735961869769, 2310250390622649784815263369822536128743468558829159661405400947804241295276893864226528226345118374450388180006498878914135431626726364364943051882931908156713783625795084968846166403182698361644103929966906488664873914019897956595477952893616379544294695925582195126581826771206725315770650772205176869338739766036018265711985287817473914767796284478652923596216727014867577626783069074153989521669121949145345908611692979948716869213189179821549857378163864524263754129165785547455523292397540685115405411629039719871417623535331169889850888784888585225028861884821533280520653433097893075814982714781428659906512, 13311047322737190997018751666204232801063170053352428175778580618990393022006917863286081554574993373053281582483751307457569275406100038226711336614158590623086108177833381629490819598677444606801212161057953199712441818799590801836279964165759950250514126158138243583862245021844455243581168372768875650104188011268328032791281354527680464936107493770900765346394332156490427951892896014618346451467964552248324326057456294501278286777897328759364612447597849193110253515861547528350967336805895811275237070835045416125681661600028828645556325782716644891011261789305857464190336572030245399099319350592823739847855, 12931927545935936938844063714383803931212290790949469494256196662152993289540736936116335173784742594482945457361484623118531391570718954242638873020145768395137669302636082230671874579404975858084530375193801721482690528812163146291481653312457541353201843627311798618668117058078212221260199286753518734454896491664026238384459165852246088334309522131112007682824851400853990034159198678258005229913411980460594874164051786461548695456652980877941332653832779337423055437122623423275773163496389876074023539740207058422406618972528436356343496463139742643226978582409533628689879928741204901068651600763533297013129, 11049459567817062990268410887793534298417893554279022043060049544268168565946971879661662737931246067443483765550545240939098292075422524404792861090248238903424134814721797546667449976910582323654730619268571126724861658659940632608804065654394707019894598267759274326431134882727634330315700057463139306731155668400588576694052707738801069750875668826267195714838627718772993181106951261118264956685027237592558246201356284003612944925199465851616610631016487536566268378199669858358224118584772638491739758731241918193541232818594534038715818803573712099344713826757883717726814225077020514743031207494973004482280, 9360568659145085519203657275499516992373465160509122431931672242541129592132400965343174617405111735675421523200227024900602679442755435260729144766746140884280474512908443727842663699548817630490816777750038445567200517872738221283335131510951348141283952803049997720758990874502182748785508780004410694876253040162593435082820616418404304027144906096320232551018748861528041281644438588470403921152132366475944576063484446914830410266830387546755834340230468025128656848800160204919404509278534310643337978408707002253329931320478545434274299002470076925060847742033786505618185233555792861261298478797203904655313, 8675420359595894698734851700094397082810120550823019942230216662798242547774793082840201088227161018002394112136967266580911176762010552358262862502506298699328825605024442575982555212422944925948242199686565873813654313544254589390589170433187616496764660739714268848087046011115149976778696920009126213238168349489967635674204542063266619757090896723810681537630225867013219889162750830521982874561296285771773878903608018816607444233637007291824969743948153789571907227575541179778143066749894727539367435362766160200920040552848180986494447770594141687167142391283543423773622177258195770746766303249264100663402, 3253591655345487717502882897423032904363314033004860661397167740588744760499398893151802061535440728662240178518169020456700675014435259725696805105601537371752044404808163552662536289631694311577403572576492048448876040645704006846173723878818857635108002783593953747416632889089402456030594641087709983928143702620640976151488055230155971442994016846872647197834795847451318780940128786233694578925052731042119547355263494433089024784685404642714737124879424985188397991749514031511609252607935308411686750786241035320764843503817386368413207379302464174873928870539199708148040262597370494676380643934701220716598, 15690976987845542477511908267927016441769547226316971269399274129989150067493751922170910853853531225175230303876376871843286284560226307911368847615338453451238676259909664219678102362343992305358014275178582778461198100510947607886437088074496719144460672714195948428144305398363591173159425374431963784375905501614136188173241980220128629585487830755852609973748858365255018439491498670109331779198946747269347274857866947197703298027274603774828311738995780309174605354172078336639100726722124212176558195095562157870856500405322352000409528919000107694026133960380003882594807059579754762024941262551724147572677, 892722895098858256945643107468776592448091543224432082038609019967395865292079089449121148448370747804339583733537279019195425022509628403682061220507046762569960328081425640344619941196942443226341475713826890288728416693680043309523251667356137336363550135940295008169014615824064085871674648889774937885124471832306653053792537729746685523772840033303286984261391631943740382153885096843210719808931110515580655438712593983116475990445774180718036481484795999745749685736884531322654100972812884225596788567822336931279490873857948135931599138696914655246696162491499517591660758986213470231148210106210145255884, 3385315724906554165893568342015359637419878399753619854510959687851413620272132901542842679116568658811813643324220517343536069120015211791045020697090254734268011315253049340738039056552073035519100988344061297720299313985025650242530120315804937622857799445726484099849159740081007339362053142038680774930438039538741260315839367778366933657495384379003042157888520011234216371762857286746041489718632807619658758956852434308962302156828846681861606060174564516011578816741805475789951397609284624099361914476114160849572539071891128956023956436697228432105677890331443808013668134019643670085140143376894845924501, 7922365369816597080586041636236084706447429587688612482263181113409241471164871306824609531951410540551972668719515420718206702327416189231530795733054327622577251676479107072295957031962078369437552408809388009748493764456001579076004239333461930375090577036483647336525730157784106254465144183749158434925622338972984828243322445087299317574534021898435131553451124321691952432833806814781833626684089489421355585609727021741822319831946645994753501940628953668159582832868584987031621836165591375076993531587519066698099750247677140741070882350784930969185238650531099122629443483692693083953950443630859147060804, 16553208212808730659372005708257666369834809600559559802072502426255223355621554337882896986483263889825559253787045973238216699691855547072864624696481402689360520110570727592431801868343386764044623739010433632320119073792515389231323241414104112265944771434026466943877206336893354825560332633555012293346930139093243494803077361093299682908874646140408505525669323254861916570824141132205134643029123131718264894120426503140498425155064188359079989683496307260561394023958285137167424693963646341550555210324895088525400822823120297889423218675582064263766473088547199663304672585665508184355377338492713059143014, 9224702247836867845996682175846444248222927394947109892873916789667864650986619390939639800966028204839034162140287676766557461306368345257251388975920084931031095238091696800385009717682250733001693009616134923965805148044380232402127207107453487714074907792815971418621792566167962365218011862432734038809462137519408153111986845596082249921143155710275735437344061121906230399512211468768368276955924237042617141936431773676885121809248558226235598141009403516262124389699139018213898101127739433995824980843332005629108131928464353443308251416037328593435124869201006489016354561841926352137493536177998246491457, 6179751216022549075159194568719652100422104011435006892912744830308424877605930981950351236563731008281743339282132869510718861876940649579358894672893094792365115405852516147832786746105152809927497411332235315384919500130187166618407947041343692926442612322045409198254826089200883962938361299192872652534935383312818764210062552219475203149508832266960497939220068646397793282737632456371362982445266139100050908505402189092005452463228121387962362403812300152665024016985569775079192488133007240698378419058498483553203568205735771647528380064347182606872997696814696712300359858900829114652152058182562171707356, 8164817952189154885220008111429746484283634461151761683369996094370090647979076576076501023148774583728922410261798475489215176371842136828698171800365552769671648130525134874259270350353004144763892266613526575336957007318250739107845556658413220817071880686159987566623105074927069955410835413051543770485418645086455823808247942095412685321310855980002350636012103170395199624441659087279538541345485345547529031546309760539435841143477980379901916624677489018472352195879755164052294126807362889540702766521516377807227467537395002510021999253272051838483718497192369061262451539408914115635817031751566360244452, 2515981718203131241515148836443435220662570690896635409310514892019131265493144735319999531099980132906095237216713733110221834338343223806226321957585961272977087431792452803141302950598442706878553725178565454524375037047652585019156280643075287475859270817252613058205107232098631819674879886158411837290611855546296457162244935089415355975082334907250131032590669925533238918918656589201184124510525556274083578885851659012063644786113730289649457656640668752748702544100934524494088381197478629603377067281359639348253488086505649655406125546944793415587091658126990666928048641519667626266172388887410544626521, 12004904131459445460766330966831667089469268032717825266238079000922498848642440450016119681025596682786575662235214188524563947089940025216619041820270693905520395099412248824437486955403798007781475406156688997068484112228770529490828669003139108187771527274746861577214428007839982600354742893612667256056238428753830611497137409983895036646323892339705698121886052490966068936881583261823906011496609902019581041287323003401971148555380589334824057418141258299577454196930279873741685569017410988166315826686783974683357091855921331838807148787134786367666309555316844799226195865358890449617059698270100689166818, 15083660077732923028685277661879722104712853216803815004503439034388043766719607550875542099831702630849072794839974789278599213842439161657895923138287079358576212011684331820056921283880475862493631994292393051067543130538181105861263207154317961184840496035200211578101952626652868476751504797259249397890553906636873253063892308036857731120978755575197054320686801779594299586451514391620848242847360714270302805059028861904164552352146126870072467614552829464353259881047858919839198479283257667310288402838451823574550251102248568448053004098996829446397031931448467637122499456430266500606851547762223124771651, 1393281060763012358464055047186087724907077770187476423369477968027276901929565777460212932503572393140692754457485972881159194035067798376388263356514907144998485492424218191361262239567600908432717700610778999336701592469008047460803224731771073497549020075742181642468187786705405988016269812517902352075362955848598181363178055025797084728052429156977296839215280455058146317673670963758668101629671558040580793404155722371309958772379428097319246469537682582570991116172357410436853628462588869505270883971675592583652688088170553160353649130862893532880914222428949113912944037837191913135043472731825610964210, 4015366605047937816945521544512555265676120068556861896721678189760324334879265432842043438079852994104240478387328473679372675992238662877195472413432771334147622422272799308158150596541560151358908471334489042860701797180537717372595795299576516635801106355770400889834227522381204930584096799143259117006639610609491942377569655596735610414497116302474669403037775003555485829676625788097953605560033013097735676481384260567684229392549164425115533882139645508005709047761325215648780726434046240596702379166696311727317411218492179759973212992037888615822455773538623676000245066273863186068501131400567105708073, 10660521357585653081009475033173138128580915561602670719465487641907472319786135783279021918546863637394638791853992285946414248906593818089724524365522704729525778172321045534143014529144393850284991774112042494600236881177591803633045345284961675933840770710922473475914928574818389678024025533326032680977081536278365691168587498597543803590260753262321166505017317856922263046278568341089115302200967745813257341072426854388666632796083918558337349001772884985965052703601093446181795794110905208041900351086834757016501926780145674886121561239073865775439353237843272909109211390936515638482551836536201027639480, 13692838010577786828359863012342723769868353874992521916755035675326743068807841243407875936508672098198209689141850127922880092325457178529510699204099495597729445389816313322036740907247305557420363093263451926042068023821234576943208317178776657528134291745190017725869990803740680065869271802074582314981675156892119878569348913618360536174835314970439950469584521597207873217601644778181502077188426427740687900726875704709376007056742660202232291656351714611497977210018390459078398786777712875893502830838342043334374575454603453494712529503006287653968550759837267942992336113206422088702550860181063066291862, 3652242728463566999102096248676411718816410600364977554340645925125152579329304297257157871796689608226111378026567772471694055444981711723786569761273136086452247380092815909725026347886189862496468405572398606353647426942964204191426802014454543212667980864328490917212005573298655218919869427473643896443763383682816760099018953131213848428389644249833781348009488732907462438269003179879700425174673525183937141954653024169881221617117629523339142774371468990429851667238102088053996947839893790290444483584443908091152482622953347232906993151146819618481817073123725986097920161243882699275870283199537565917476, 4553799631997875393480795359291971685324561772905137293462723006051804458174944480052905075216609895703500974738759835130280358506415695818045225362012463045971205569706154290819044277897777384701431893208761430176337797684881437100847169910792920941334121678836426463883287529659293358603885217833640623393366281562151622604736529418408774667002871303610263859116557151979865398361976382069755278595460043072366340729729704876539823259998817723517988567022998605770229745891672856454902599875561067791483103697383382458153559475609142426186828882123984442633228588525372158750897437584301312924767639154539873547397, 14237629767769814411756604060065975336953017609374201196879929822147266677717406064543922856263648213669075765180274077564016544033626185824699197868713538857371401492107717323191573198729430548245308657984504598774983977088499382295359320445105148164329469612385087167438940633700375763362549902800675710437223122600456401868174641038940611597662344322921317421880614799688169974320491213135963535948314831420934618809831292355142042650246764274633746438725352335960392757199316298094453161261345457460154613516750231318702807416256447470729516560586377858580001604815055650044194963704580713849441404670714721903275, 14797999537174405832707140386324374426771945777178994123389019807761675766184404544044842265087407336900090117664086093447053635680546962443151857558044524296908591325617976526176598548562214937172955762794771301352475569293808468140718911906412642170648405505464137210494524233099544566314422741988860570898087730704882594688365543281401307895586614706502820320539180214553915330158467310463088992783174624422201475609206909681823946527274204558851973667972658853229380396417422440476231059384753222611094202690469123585185109757651248273334040538118832840348797444963726390710848712772985713582872305102515501773139, 12380131984364331866867849813464646509743936143703470966634390994464279745494276155694778217946960551607050389931718517099199773525414231611227561092019640113954302585467665618138146202261907905463217000412981238003454684992598647773812444471320845732157106971268087015289052050636034952147596018275721991938073160426007964220874217028614458282938611717996783813150289538461441497259120113345264468479880179404438731650602592483723415842187308610935876904077153732577499073264359068550498424853493259417295647225842230423042363098298376125767842923225467241378605839769958375174286969770330889375049376537823075874294, 15694213497311580884873484701145567177448945099507964158193683374396003863237942445639632067797375663802069969007541408810009742952506936649841556425408735187287825479047628369791681606451401126851414597775809867137475775561540160623116950106082368697747535453367850205164661855475598220885597204830817072927318802902150404696867171664508577334133104753740623852156120881256564175232069453515821560086370609603955053356367052834717293894436856414549081538215612636965490451611908543254450398678627473109619169753290015586437154733523435701375363483619473135043829097027440885299089053325610779987214381287031426639996, 2930363960131086072517660631007730254837280307016316339112601746168799151536113734359271789670469644804390317543271694041044665661884166092326744018868084387470465273702341039382247021294951814597008596240592207618318947009966081511191109764120979005495031358410771095553462656708222588977357261726220289314233596949931166927872542938299556079176994034836406795955864641669753586224030314800658498868771579074158945691569674496238442414252378564021903611939753406270883019986106909502855992670847665569253819927407195365809340868026221659912322486599554255574158253104179195721271610863507373006114722925980666986439, 15377187872502836354069442784820569785800443869595570635953575708363829800970447927229408155997731581122537451853858099432086568855589245090388230342162690463997767606497631081299883410174151423365172217907859056041107135678843228909555008070966135379304305260802182636910189904949791524655505486377878781958168872277365314523834280241896934805739048016709981800471934071278348726359360473216176316361612186384002678981956302717467892079313486620224227570335562401978559803461528193823758020702933116394186342930570128526351534180340119161216197839197892938162535812476592148059940563085717625664149264792110443748043, 2478866148089930559833822584860766881419935748339478338488392064274800210155784760572436502183752815860982746162214065301230572997812535302757821433455295651698652860767348516856061069604196279966731139798898945936004906387737092462942316573878427875497550712802533945388164382894816449782626899771463778076347419217014588331774294689957940454090610062721764593521482145397586025433932701127094862387664651477364190501944052494637793267920008299188173199612899680566015822582719572532537498312450640687825871058974975042827963262749617394824717297274953818632995731040779322973150857390340138597391876259369567258518, 11052852977460213181882669902296693983667783411534817316197253448906093002334433352232833081309091795634849005337561226806686678020687532378816295337236817002662029276441204959682941867417581873673847290192701901745174383929822930128040952150683382719415586460275624854599398588995864689272874309515289499011332345223852559028337605376385389918498877755973474173650059971187552524208879173280839800110130516716612611703322074110601807771643259010482375564340949783993123498530444975498100373495271402969687235305272489795360950614616766742729201102445044516450866608768688714803681012411505884323952624394725751028890, 8121674599906183523661735226264506560926991314825065145237852498634566316074113295389911563665740511475045434012797619399022161936719325317733832260408798175859600922245010939060382534732518092695770198008594301261821778052605118288960107754726554715003861319056768961969490511056018217184860983179927789664535820110007913171209780943113614643915977557375064163985792672456430627611305867336866811118420492003696332888555236238594989994941047342441057296392627238421014921510460463678170348960197198097572076446324923481842341420132403778573341601841672449498435891449795258291530757294842328767622671046918692493732, 3621889925781588140444331013004047965788466366486523471736676802624471423246717670083886677565962212740689278714412166437317750751506618133037912351712921831125069555532716772070130883871006075890638193970884616579158253199773855959250828203461070149502707753631534550677383032186714561598654802677892315222856747976273009115009269157590265420651480762809821753075842737861038355383801135212016820067921983313975337213186637587999788366275143071556272449733278229013059339734585761950246083204400006260585545907601362100791042126041683040326715116299412595800209921631448752195378344887225703881807395312806642980237, 5010011417026084873463665776523632166067409177881321081496921906628418892063697126909568711791058756319027053047966621616750220399538882587778857152280507991493317642390131052207089490676145146386276442057389173402629065421471429403203418495825488129543066355108898214572020344625228624362958611289317337441210625374184161265492578847358913967763236877594573657933025361030760147275243182819064757923472141900494347509477287982037212003638359913958859107734716181983422289087662604172901151725567711211024969658481668466374047144519039543749941771524566039744430525138722518509192044384779024247758681681744244649639, 16428992079052695524199075980368050474998400617362995858537382373956817330768299768093928162149811220299375596741491028003439860817368478717904626919862335667082578042258696470220657295198646167323713506102292605146124519153205621438671749059482958356077101083490510239942096672576655332703861515899236282008099656452371156599399723307213191322180988563862209817159669748851854358341848636539966459093643640106830328449491030740247082114794128381830462472161256429439832429154738262314398491850913943605234281064698622222387793022048706071979961962725931393793571015390457247471264692673213082924532539966374510399343, 9512575557183081299926592312104594619985617802764939347399164172936116965408910264278966783332905310140782767674035534130191767844609307762814863907930305033222530653123543676701214293101093779728478913376509300010708620251326401989946513789586950059853441699642616967888344713827545626163463574279009547981977667162498039684729585437530013623346544338566559271379437290990924674678194906088881019721518757501211976279659120101905394245823103426043709203657802148686611817754842276925337518093347002990771462731167760379023886118968493975616972691130675363604101369232202727235502196973245215763769912819174261093254, 8954674025902740757583248145515576020000258948646257237674198787301644289724601480860261543288715794267633209833412156438484149192973610992125378835776142509752505712058239585369264036983031460630434648634495576562636959789479321614301201539434141907884061760444460745101549848594807450354046222474922070866458801121559927657671742329360760575268590749154509457959125229760531813412861690160520452532346464391540892877530545713822365471083827776063282045401848746977711681681646900450984706411975304791571856711829667955264679025023714552478324284279814755368903128975691823095722000335084784888584265109630868777943, 10091374643364575703532849598128336155848039506383454297495540589512553778766252044111708195744775071317677942234416517877374671137753386411333961172608524131959257340051760154129052786828816614295336762575755108272726809669314314809946412459565487654838984532188207363437630752365964710932549141605640198347169600224518176272414489415912459636864194452372123582743472904318069422618116953265469373374724786107060407621182289509353469415817261720993539437292139755675687115183914563192817283100687386700184899704221534351932093861264056398766004677290034000752280847476895800087668104834573671671701508686575024622335, 11831079207066771227240970174811001130854881297639460468894597868892672848963722090309292878244486676829556713644889888753331038783164729717297165497979191858296783197418375278681169708778073864058027141361873692404212546337298362741589642620150553922924049120583162570118872555679258043143340512121862783279454656432939796345250024410323460000361119114115968068712275185158476517706028041476828264499920182834946189881749903457992343058775399907003115088424212191027833570584055313485896000461512505350949240611160096510913647819158217479093409817422374874362412443476117032609190026308795514256030572224355240899833, 1040230763956022393233891944772092425190052987379606012742916182589096485140845191945936671201277996888581428681162097938959217657177045904706941316051857240726601622935213085552575331350077568036807569050505525168501530045176362809566625040763719972030419844342263055723809664352126099857272641532233642881075272991128418234362451848058979927001087070700784134751874697451002324353469449251323464986107806965680159392350698641782856723527914359153060115852691450306648922049471469681447463071118760648600243468908727965921401480083821823223949582145222242551112757773184665306887818509282650161064168396451118192990, 11239577141759909972785717065280269652108901432646253951354172278400379507927864398507310938870716399069009447282407106395992220374616292455121738972076538045368175141755416141399883047611947501225250371248428564113316165517307961627454542865902370807663557736823191221128051515220695573744011528986617857510330010438963560759026800423104349612243603388957241146483224802430571340177521225039356611494621127086696473239061766147425433218254575813305180314189577734257674125090556800628952598750848440247688205552061045043029009568197709161055869380248787905843561345414202527400061334033467396112980762783710905130358, 10846995379132300672811696077898277440023742577811224233052796550456182869061022316027930453261984812473028082416350112269531296549547596343248719815579027509922307238797951928198578199826731741903859080003540661655444254953080849030755030920132379832313815024493147616376322304798474752139324635704979832666861960733522380379746327713478294847055773060105416400155546320212399749351282916330672539301604155973884284658433056717687537776976813393375018415411613046511665243935844320898758418414297103944674536288165242580800097279391267001390074181290179266358546887406540324720744182060218227551330312453898377136171, 10499837095536264768926628388744292477451297960658516452604090565540496525066277123963529462544111511048270418536450109430011411272961311065803935765737250250634949523195679140449075784718219195747447550764659424606171183706409207367865492055547383092557276764161602891147191093144434446531973714775730205321912520679673656636160740070735769831642467269638467656334246906824051179783924665015980490224285881403302167850943718610152856712261020313857693854245784222536834818510124063926433453324356707678423914833536055579778551222061628403891306669476763512578750012093444320448205914405794798018213711275911044614748, 12053405848063258775961014484900043189653873902800350228280721278530485226688377602559832610250256857792781684707173824865953668790895870681701790227396021145879071778373947956402274643981104211767531345948652486463445673789006561403073668906794668024762803985227394432551632895242317641029065742757897082894062128180451175224546714877049404469637303095833490665329404108104303305225315056688079206079272997008949194927518231465569089464688419627978199590342083114098961320453616239807246792450525493078398045765594193536332583067222586242776422803502440433575460570701325176476761316921849076621564650697343235487982, 15527218420663812211395723469198944401093018861140799157642668378937335248173170413981872854700054314693381233111806404675400820323329470151856312768740929019479732157532126096991625308787871061616820663482232636329182036026835151188600325495005931830592992969358882212773056574019874850603211491870438474918283736240446327237768014990093908304905723115918553362691204423938954855109836639855773560929798690812009809065573971842324096094515618087569064523004613315760547243668901677446916281029933206646092917618023783132172792633809101823887045946084085440546374653446738789374926477260942643440001300541602305907370]
	# print(len(enc_flag))

	known = bytes.hex(b"ictf{")
	nonce = get_nonce(known, enc_flag)
	# print(nonce)
	# print(known)

	# Get LCG params
	m = get_mod(nonce) 
	a = get_mult(nonce, m)
	b = get_inc(nonce, a, m) 

	# print(f"m: {m}")
	# print(f"a: {a}")
	# print(f"b: {b}")

	"""
	CHECK
	"""
	assert nonce[1] == (a * nonce[0] + b) % m
	assert pow(e, int(known[0], 16), n) * pow(nonce[0], -1, n) % n == enc_flag[0]

	FLAG = known + crack(m, a, b, nonce[-1], enc_flag[10:])
	FLAG = bytes.fromhex(FLAG)
	print(FLAG)

# ictf{d0n'7_us3_b4d_n0nc3s_k1d5}